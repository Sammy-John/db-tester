<Window x:Class="DbLab.App2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="DB Lab — Schema Explorer &amp; Query Pad" Height="700" Width="1100"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320"/>
            <ColumnDefinition Width="8"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="28"/>
        </Grid.RowDefinitions>

        <!-- Left Pane: Connection + Refresh + Tables -->
        <DockPanel Grid.Column="0" Margin="10">
            <StackPanel DockPanel.Dock="Top" Margin="0,0,0,10">
                <TextBlock Text="Connection String" FontWeight="SemiBold" />
                <TextBox Text="{Binding ConnectionString, UpdateSourceTrigger=PropertyChanged}"
                         ToolTip="Edit and restart app to re-create adapter (simple v1 approach)"
                         Margin="0,4,0,8" />
                <Button Content="Refresh Tables"
                        Command="{Binding RefreshTablesCommand}"
                        Height="32" />
            </StackPanel>

            <GroupBox Header="Tables (dbo)" Padding="6">
                <TreeView ItemsSource="{Binding Tables}">
                    <TreeView.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="2">
                                <TextBlock Text="{Binding Name}" />
                                <TextBlock Text="  (" Foreground="#888"/>
                                <TextBlock Text="{Binding ApproxRowCount}" Foreground="#888"/>
                                <TextBlock Text=" rows)" Foreground="#888"/>
                            </StackPanel>
                        </DataTemplate>
                    </TreeView.ItemTemplate>
                </TreeView>
            </GroupBox>
        </DockPanel>

        <Grid Grid.Column="1" Background="#DDD"/>

        <!-- Right Pane: Query Pad + Results -->
        <Grid Grid.Column="2" Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="180"/>
                <RowDefinition Height="8"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,6">
                <TextBlock Text="SQL" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <Button Content="Run (Ctrl+Enter)"
                    Command="{Binding RunQueryCommand}"
                    Height="32" />
            </StackPanel>

            <TextBox Grid.Row="1"
                     Text="{Binding QueryText, UpdateSourceTrigger=PropertyChanged}"
                     AcceptsReturn="True"
                     VerticalScrollBarVisibility="Auto"
                     HorizontalScrollBarVisibility="Auto"
                     FontFamily="Consolas"
                     FontSize="13"
                     TextWrapping="NoWrap"/>

            <Border Grid.Row="2"/>

            <DataGrid Grid.Row="3"
                      ItemsSource="{Binding Results}"
                      AutoGenerateColumns="True"
                      IsReadOnly="True"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      HeadersVisibility="Column"
                      AlternatingRowBackground="#F7F7F7"/>
        </Grid>

        <StatusBar Grid.Row="1" Grid.ColumnSpan="3">
            <StatusBarItem>
                <TextBlock Text="{Binding Status}" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
